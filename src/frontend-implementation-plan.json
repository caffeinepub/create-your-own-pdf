{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Replace PDF translator with AI-based translation service",
  "requirements": [
    {
      "id": "REQ-18",
      "summary": "Replace MyMemory translation API with AI-based translation service for more reliable and accurate PDF translations",
      "acceptanceCriteria": [
        "PDF translator uses an AI-based translation API instead of MyMemory",
        "Translation successfully processes uploaded PDF documents",
        "Translated text maintains reasonable accuracy and context",
        "Error handling provides clear feedback if translation fails",
        "Translation progress indicator works correctly throughout the process"
      ],
      "file_operations": [
        {
          "path": "frontend/src/pages/PdfTranslator.tsx",
          "operation": "modify",
          "description": "Replace the MyMemory API integration with an AI-based translation service (such as OpenAI GPT or similar client-accessible AI translation API). Update the translateText function to call the new AI translation API with proper error handling and response parsing. Maintain the existing PDF.js text extraction flow and pdf-lib PDF generation logic. Ensure translation progress updates correctly reflect the new API's response patterns. Add retry logic for failed translation requests and provide clear user feedback for API errors."
        },
        {
          "path": "frontend/src/utils/aiTranslator.ts",
          "operation": "create",
          "description": "Create a dedicated AI translation utility module that encapsulates the AI translation API logic. Export a translateText function that accepts source text, source language, and target language parameters. Implement proper request formatting for the chosen AI translation service, handle API authentication if required (using environment variables or client-side configuration), parse AI responses to extract translated text, and implement error handling with descriptive error messages. This module should be agnostic to PDF processing and reusable for any text translation needs."
        }
      ]
    },
    {
      "id": "REQ-19",
      "summary": "Ensure reliable PDF text extraction, complete translation of all content, and generation of downloadable translated PDF with preserved formatting",
      "acceptanceCriteria": [
        "Text extraction from PDF works consistently across different PDF formats",
        "All extracted text content is successfully translated",
        "Generated PDF maintains original document structure and layout where possible",
        "Download functionality produces a valid, readable PDF file",
        "Users receive clear feedback at each stage of the translation process"
      ],
      "file_operations": [
        {
          "path": "frontend/src/pages/PdfTranslator.tsx",
          "operation": "modify",
          "description": "Enhance the PDF text extraction logic using PDF.js to handle edge cases and different PDF formats more robustly. Ensure all text items from all pages are extracted and concatenated properly. Implement batch translation logic that processes all extracted text through the AI translation service, handling large documents by chunking if necessary. Improve the PDF generation process using pdf-lib to better preserve original document structure, font sizes, and page layouts where possible. Add comprehensive progress indicators for each stage (extraction, translation, PDF generation) with percentage completion. Implement detailed error handling at each stage with user-friendly error messages that explain what went wrong and suggest potential solutions."
        }
      ]
    }
  ]
}